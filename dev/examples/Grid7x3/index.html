<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>2D Lattice Â· MultiscaleGraphSignalTransforms.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="MultiscaleGraphSignalTransforms.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MultiscaleGraphSignalTransforms.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../P64/">1D Path</a></li><li class="is-active"><a class="tocitem" href>2D Lattice</a><ul class="internal"><li><a class="tocitem" href="#Set-up"><span>Set up</span></a></li><li><a class="tocitem" href="#ROT-distance"><span>ROT distance</span></a></li><li><a class="tocitem" href="#DAG-distance"><span>DAG distance</span></a></li><li><a class="tocitem" href="#TSD-distance"><span>TSD distance</span></a></li></ul></li><li><a class="tocitem" href="../Sunflower/">Sunflower Graph</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Functions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../functions/Partition/">Recursive Graph Partitioning</a></li><li><a class="tocitem" href="../../functions/HGLET/">Hierarchical Graph Laplacian Eigen Transform</a></li><li><a class="tocitem" href="../../functions/GHWT/">Generalized Haar-Walsh Transform</a></li><li><a class="tocitem" href="../../functions/eGHWT/">extended Generalized Haar-Walsh Transform</a></li><li><a class="tocitem" href="../../functions/NGWD/">Natural Graph Wavelet Dictionaries</a></li><li><a class="tocitem" href="../../functions/Utils/">Utils</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>2D Lattice</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>2D Lattice</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/UCD4IDS/MultiscaleGraphSignalTransforms.jl/blob/master/docs/src/examples/Grid7x3.md" title="Edit on GitHub"><span class="docs-icon fab">ï‚›</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Metrics-of-Graph-Laplacian-Eigenvectors-on-P_7-\\times-P_3"><a class="docs-heading-anchor" href="#Metrics-of-Graph-Laplacian-Eigenvectors-on-P_7-\\times-P_3">Metrics of Graph Laplacian Eigenvectors on <span>$P_7 \times P_3$</span></a><a id="Metrics-of-Graph-Laplacian-Eigenvectors-on-P_7-\\times-P_3-1"></a><a class="docs-heading-anchor-permalink" href="#Metrics-of-Graph-Laplacian-Eigenvectors-on-P_7-\\times-P_3" title="Permalink"></a></h1><h2 id="Set-up"><a class="docs-heading-anchor" href="#Set-up">Set up</a><a id="Set-up-1"></a><a class="docs-heading-anchor-permalink" href="#Set-up" title="Permalink"></a></h2><pre><code class="language- hljs">using MultiscaleGraphSignalTransforms, LightGraphs, MultivariateStats
using Plots, LaTeXStrings, LinearAlgebra

# compute the graph related quantities
Nx, Ny = 7, 3
G = LightGraphs.grid([Nx, Ny])
N = nv(G)
L = Matrix(laplacian_matrix(G))
Q = incidence_matrix(G; oriented = true)
ğ›Œ, ğš½ = eigen(L)
ğš½ = ğš½ .* sign.(ğš½[1, :])&#39;  # sign of DCT
âˆ‡ğš½ = Q&#39; * ğš½
W = 1.0 * adjacency_matrix(G)

# manually set up the mapping between 1D ordering and 2D ordering
grid2eig_ind = [1,2,3,6,8,12,15,4,5,7,9,13,16,18,10,11,14,17,19,20,21];
eig2grid_ind = sortperm(grid2eig_ind);
eig2dct = Array{Int64,3}(undef, Nx, Ny, 2);
for i = 1:Nx; for j = 1:Ny; eig2dct[i,j,1] = i-1; eig2dct[i,j,2] = j-1; end; end
eig2dct = reshape(eig2dct, (N, 2)); eig2dct = eig2dct[eig2grid_ind, :];
nothing # hide</code></pre><p>Let us see the comparison between 1D ordering vs. 2D ordering of the eigenvectors.</p><pre><code class="language- hljs">## 1D ordering: non-decreasing eigenvalue ordering
plot(layout = Plots.grid(3, 7))
for i in 1:N
    heatmap!(reshape(ğš½[:, i], (Nx, Ny))&#39;, c = :viridis, cbar = false,
                clims = (-0.4,0.4), frame = :none, ratio = 1, ylim = [0, Ny + 1],
                title = latexstring(&quot;\\phi_{&quot;, i-1, &quot;}&quot;), titlefont = 12,
                subplot = i)
end
plot!(size = (815, 350)) # hide</code></pre><pre><code class="language- hljs">## 2D ordering: natural frequency ordering
plot(layout = Plots.grid(3, 7))
for i in 1:N
    k = grid2eig_ind[i]
    heatmap!(reshape(ğš½[:,k], (Nx, Ny))&#39;, c = :viridis, cbar = false,
                clims = (-0.4,0.4), frame = :none, ratio = 1, ylim = [0, Ny + 1],
                title = latexstring(&quot;\\varphi_{&quot;, string(eig2dct[k,1]),
                &quot;,&quot;, string(eig2dct[k,2]), &quot;}&quot;), titlefont = 12, subplot = i)
end
plot!(size = (815, 350)) # hide</code></pre><p>What we really want to do is to <em>organize</em> those eigenvectors based on their natural frequencies or their behaviors instead of their eigenvalues. To do that, we utilize the metrics discussed in the <a href="https://www.math.ucdavis.edu/~saito/publications/metgraphlap.html">paper</a> as follows. But first, we create a custom plotting function for later use.</p><pre><code class="language-julia hljs">function grid7x3_mds_heatmaps(E, ğš½; Nx = 7, Ny = 3, annotate_ind = 1:N, plotOrder = 1:N)
    # set up all heatmap plots&#39; positions
    max_x = maximum(E[1, :]); min_x = minimum(E[1, :])
    width_x = max_x - min_x
    max_y = maximum(E[2, :]); min_y = minimum(E[2, :])
    width_y = max_y - min_y
    dx = 0.005 * width_x; dy = dx;
    xej = zeros(Nx, N); yej=zeros(Ny, N);
    a = 5.0; b = 7.0;
    for k = 1:N
        xej[:,k] = LinRange(E[1,k] - Ny * a * dx, E[1, k] + Ny * a * dx, Nx)
        yej[:,k] = LinRange(E[2,k] - a * dy, E[2, k] + a * dy, Ny)
    end

    plot()
    for k in plotOrder
        if k in annotate_ind
            heatmap!(xej[:, k], yej[:, k], reshape(ğš½[:, k], (Nx, Ny))&#39;, c = :viridis,
                     colorbar = false, ratio = 1, annotations = (xej[4, k],
                     yej[3, k] + b*dy, text(latexstring(&quot;\\varphi_{&quot;,
                     string(eig2dct[k, 1]), &quot;,&quot;, string(eig2dct[k, 2]), &quot;}&quot;), 10)))
        else
            heatmap!(xej[:, k], yej[:, k], reshape(ğš½[:, k], (Nx, Ny))&#39;, c = :viridis,
                     colorbar = false, ratio = 1)
        end
    end
    plt = plot!(xlim = [min_x - 0.12 * width_x, max_x + 0.12 * width_x],
                ylim = [min_y - 0.16 * width_y, max_y + 0.16 * width_y],
                grid = false, clims = (-0.4, 0.4),
                xlab = &quot;Xâ‚&quot;, ylab = &quot;Xâ‚‚&quot;)
    return plt
end</code></pre><h2 id="ROT-distance"><a class="docs-heading-anchor" href="#ROT-distance">ROT distance</a><a id="ROT-distance-1"></a><a class="docs-heading-anchor-permalink" href="#ROT-distance" title="Permalink"></a></h2><p>Before we measure the ROT distance between the eigenvectors, we convert them to probability mass functions by taking entrywise squares. After we got the ROT distance matrix of the eigenvectors, we visualize the arrangement of the eigenvectors in <span>$\mathbb{R}^{2}$</span> via <a href="https://en.wikipedia.org/wiki/Multidimensional_scaling#Classical_multidimensional_scaling">the classical MDS embedding</a>.</p><pre><code class="language- hljs">## ROT distance
D = natural_eigdist(ğš½, ğ›Œ, Q; Î± = 0.5, input_format = :pmf1, distance = :ROT)
E = transform(fit(MDS, D, maxoutdim=2, distances=true))
grid7x3_mds_heatmaps(E, ğš½)
plot!(size = (815, 611)) # hide</code></pre><h2 id="DAG-distance"><a class="docs-heading-anchor" href="#DAG-distance">DAG distance</a><a id="DAG-distance-1"></a><a class="docs-heading-anchor-permalink" href="#DAG-distance" title="Permalink"></a></h2><p>We organize the eigenvectors by the DAG distance.</p><pre><code class="language- hljs">D = natural_eigdist(ğš½, ğ›Œ, Q; distance = :DAG)
E = transform(fit(MDS, D, maxoutdim=2, distances=true))
grid7x3_mds_heatmaps(E, ğš½)
plot!(size = (815, 611)) # hide</code></pre><h2 id="TSD-distance"><a class="docs-heading-anchor" href="#TSD-distance">TSD distance</a><a id="TSD-distance-1"></a><a class="docs-heading-anchor-permalink" href="#TSD-distance" title="Permalink"></a></h2><p>We organize the eigenvectors by the TSD distance with the parameter <span>$T = 0.1$</span>.</p><pre><code class="language- hljs">D = natural_eigdist(ğš½, ğ›Œ, Q; T = 0.1, distance = :TSD)  # T = 0.1
E = transform(fit(MDS, D, maxoutdim=2, distances=true))
grid7x3_mds_heatmaps(E, ğš½)
plot!(size = (815, 611)) # hide</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../P64/">Â« 1D Path</a><a class="docs-footer-nextpage" href="../Sunflower/">Sunflower Graph Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.16 on <span class="colophon-date" title="Friday 29 April 2022 00:15">Friday 29 April 2022</span>. Using Julia version 1.6.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
